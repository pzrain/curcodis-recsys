n =  381216
sizes of edges =  381216
batch_size =  635
src/main_edge_cur_rearrange.py:204: RuntimeWarning: invalid value encountered in divide
  ndcg = dcg / idcg
Early Stop!
Epoch  0  trn-loss: 445.4952  ndcg: 0.0082
Early Stop!
Epoch  1  trn-loss: 428.6258  ndcg: 0.0085
Early Stop!
Epoch  2  trn-loss: 436.9911  ndcg: 0.0073
Early Stop!
Epoch  3  trn-loss: 447.2236  ndcg: 0.0074
Early Stop!
Epoch  4  trn-loss: 439.8250  ndcg: 0.0086
Early Stop!
Epoch  5  trn-loss: 436.9150  ndcg: 0.0066
Early Stop!
Epoch  6  trn-loss: 418.4135  ndcg: 0.0078
Early Stop!
Epoch  7  trn-loss: 413.1435  ndcg: 0.0075
Early Stop!
Epoch  8  trn-loss: 446.7470  ndcg: 0.0078
Early Stop!
Epoch  9  trn-loss: 424.1552  ndcg: 0.0088
Early Stop!
Epoch  10  trn-loss: 440.1353  ndcg: 0.0073
Early Stop!
Epoch  11  trn-loss: 427.8286  ndcg: 0.0075
Early Stop!
Epoch  12  trn-loss: 400.3727  ndcg: 0.0082
Early Stop!
Epoch  13  trn-loss: 399.9502  ndcg: 0.0069
Early Stop!
Epoch  14  trn-loss: 453.0372  ndcg: 0.0071
Early Stop!
Epoch  15  trn-loss: 442.4302  ndcg: 0.0082
Early Stop!
Epoch  16  trn-loss: 438.8691  ndcg: 0.0077
Early Stop!
Epoch  17  trn-loss: 378.6158  ndcg: 0.0074
Early Stop!
Epoch  18  trn-loss: 421.5874  ndcg: 0.0080
Early Stop!
Epoch  19  trn-loss: 413.9572  ndcg: 0.0080
Early Stop!
Epoch  20  trn-loss: 417.5312  ndcg: 0.0077
Early Stop!
Epoch  21  trn-loss: 431.4764  ndcg: 0.0081
Early Stop!
Epoch  22  trn-loss: 394.3870  ndcg: 0.0063
Early Stop!
Epoch  23  trn-loss: 444.8734  ndcg: 0.0077
Early Stop!
Epoch  24  trn-loss: 412.0632  ndcg: 0.0073
Early Stop!
Epoch  25  trn-loss: 424.0204  ndcg: 0.0078
Early Stop!
Epoch  26  trn-loss: 417.2401  ndcg: 0.0081
Early Stop!
Epoch  27  trn-loss: 412.3883  ndcg: 0.0074
Early Stop!
Epoch  28  trn-loss: 424.1438  ndcg: 0.0068
Early Stop!
Epoch  29  trn-loss: 419.3113  ndcg: 0.0073
Early Stop!
Epoch  30  trn-loss: 408.1864  ndcg: 0.0079
Early Stop!
Epoch  31  trn-loss: 420.6444  ndcg: 0.0070
Early Stop!
Epoch  32  trn-loss: 435.7471  ndcg: 0.0078
Early Stop!
Epoch  33  trn-loss: 430.1334  ndcg: 0.0067
Early Stop!
Epoch  34  trn-loss: 397.7373  ndcg: 0.0072
Early Stop!
Epoch  35  trn-loss: 417.0042  ndcg: 0.0074
Early Stop!
Epoch  36  trn-loss: 414.0056  ndcg: 0.0071
Early Stop!
Epoch  37  trn-loss: 392.1656  ndcg: 0.0065
Early Stop!
Epoch  38  trn-loss: 410.2725  ndcg: 0.0072
Early Stop!
Epoch  39  trn-loss: 428.2917  ndcg: 0.0068
Early Stop!
Epoch  40  trn-loss: 414.0462  ndcg: 0.0077
Early Stop!
Epoch  41  trn-loss: 409.0303  ndcg: 0.0080
Early Stop!
Epoch  42  trn-loss: 412.3712  ndcg: 0.0072
Early Stop!
Epoch  43  trn-loss: 444.1009  ndcg: 0.0068
Early Stop!
Epoch  44  trn-loss: 379.8346  ndcg: 0.0071
Early Stop!
Epoch  45  trn-loss: 397.0623  ndcg: 0.0067
Early Stop!
Epoch  46  trn-loss: 422.7613  ndcg: 0.0085
Early Stop!
Epoch  47  trn-loss: 391.9300  ndcg: 0.0072
Early Stop!
Epoch  48  trn-loss: 396.8245  ndcg: 0.0077
Early Stop!
Epoch  49  trn-loss: 404.3871  ndcg: 0.0082
Early Stop!
Epoch  50  trn-loss: 405.2487  ndcg: 0.0070
Early Stop!
Epoch  51  trn-loss: 390.4174  ndcg: 0.0058
Early Stop!
Epoch  52  trn-loss: 371.8127  ndcg: 0.0080
Early Stop!
Epoch  53  trn-loss: 422.5721  ndcg: 0.0079
Early Stop!
Epoch  54  trn-loss: 401.2582  ndcg: 0.0085
Early Stop!
Epoch  55  trn-loss: 401.0763  ndcg: 0.0079
Early Stop!
Epoch  56  trn-loss: 388.6975  ndcg: 0.0077
Early Stop!
Epoch  57  trn-loss: 416.1183  ndcg: 0.0077
Early Stop!
Epoch  58  trn-loss: 379.5587  ndcg: 0.0074
Early Stop!
Epoch  59  trn-loss: 395.3240  ndcg: 0.0067
Early Stop!
Epoch  60  trn-loss: 417.7426  ndcg: 0.0082
Early Stop!
Epoch  61  trn-loss: 408.8359  ndcg: 0.0078
Early Stop!
Epoch  62  trn-loss: 406.1795  ndcg: 0.0073
Early Stop!
Epoch  63  trn-loss: 380.9959  ndcg: 0.0068
Early Stop!
Epoch  64  trn-loss: 369.6412  ndcg: 0.0069
Early Stop!
Epoch  65  trn-loss: 399.0246  ndcg: 0.0064
Early Stop!
Epoch  66  trn-loss: 396.1644  ndcg: 0.0101
Early Stop!
Epoch  67  trn-loss: 394.4548  ndcg: 0.0071
Early Stop!
Epoch  68  trn-loss: 409.0697  ndcg: 0.0071
Early Stop!
Epoch  69  trn-loss: 446.3416  ndcg: 0.0068
Early Stop!
Epoch  70  trn-loss: 377.9478  ndcg: 0.0059
Early Stop!
Epoch  71  trn-loss: 411.7633  ndcg: 0.0063
Early Stop!
Epoch  72  trn-loss: 407.8173  ndcg: 0.0060
Early Stop!
Epoch  73  trn-loss: 399.7946  ndcg: 0.0078
Early Stop!
Epoch  74  trn-loss: 404.5992  ndcg: 0.0068
Early Stop!
Epoch  75  trn-loss: 392.6420  ndcg: 0.0069
Early Stop!
Epoch  76  trn-loss: 389.3076  ndcg: 0.0096
Early Stop!
Epoch  77  trn-loss: 409.8205  ndcg: 0.0074
Early Stop!
Epoch  78  trn-loss: 409.6418  ndcg: 0.0069
Early Stop!
Epoch  79  trn-loss: 388.5044  ndcg: 0.0069
Early Stop!
Epoch  80  trn-loss: 396.0088  ndcg: 0.0060
Early Stop!
Epoch  81  trn-loss: 397.4344  ndcg: 0.0065
Early Stop!
Epoch  82  trn-loss: 385.6726  ndcg: 0.0057
Early Stop!
Epoch  83  trn-loss: 384.3954  ndcg: 0.0070
Early Stop!
Epoch  84  trn-loss: 409.2965  ndcg: 0.0075
Early Stop!
Epoch  85  trn-loss: 416.5198  ndcg: 0.0069
Early Stop!
Epoch  86  trn-loss: 395.9405  ndcg: 0.0074
Early Stop!
Epoch  87  trn-loss: 395.4444  ndcg: 0.0066
Early Stop!
Epoch  88  trn-loss: 398.6004  ndcg: 0.0074
Early Stop!
Epoch  89  trn-loss: 395.0899  ndcg: 0.0069
Early Stop!
Epoch  90  trn-loss: 422.7899  ndcg: 0.0064
Early Stop!
Epoch  91  trn-loss: 401.1078  ndcg: 0.0072
Early Stop!
Epoch  92  trn-loss: 404.6286  ndcg: 0.0080
Early Stop!
Epoch  93  trn-loss: 393.6839  ndcg: 0.0080
Early Stop!
Epoch  94  trn-loss: 411.8489  ndcg: 0.0070
Early Stop!
Epoch  95  trn-loss: 393.5693  ndcg: 0.0063
Early Stop!
Epoch  96  trn-loss: 417.6188  ndcg: 0.0055
Early Stop!
Epoch  97  trn-loss: 417.6670  ndcg: 0.0069
Early Stop!
Epoch  98  trn-loss: 408.0600  ndcg: 0.0071
Early Stop!
Epoch  99  trn-loss: 382.3826  ndcg: 0.0070
Early Stop!
Epoch  100  trn-loss: 401.6995  ndcg: 0.0062
Early Stop!
Epoch  101  trn-loss: 406.7682  ndcg: 0.0068
Early Stop!
Epoch  102  trn-loss: 404.1674  ndcg: 0.0072
Early Stop!
Epoch  103  trn-loss: 400.3731  ndcg: 0.0076
Early Stop!
Epoch  104  trn-loss: 383.0011  ndcg: 0.0076
Early Stop!
Epoch  105  trn-loss: 393.5890  ndcg: 0.0080
Early Stop!
Epoch  106  trn-loss: 381.0408  ndcg: 0.0068
Early Stop!
Epoch  107  trn-loss: 364.9079  ndcg: 0.0077
Early Stop!
Epoch  108  trn-loss: 392.2332  ndcg: 0.0074
Early Stop!
Epoch  109  trn-loss: 377.7509  ndcg: 0.0076
Early Stop!
Epoch  110  trn-loss: 377.5548  ndcg: 0.0069
Early Stop!
Epoch  111  trn-loss: 392.7128  ndcg: 0.0076
Early Stop!
Epoch  112  trn-loss: 399.7928  ndcg: 0.0069
Early Stop!
Epoch  113  trn-loss: 376.5013  ndcg: 0.0076
Early Stop!
Epoch  114  trn-loss: 400.8877  ndcg: 0.0077
Early Stop!
Epoch  115  trn-loss: 390.8844  ndcg: 0.0071
Early Stop!
Epoch  116  trn-loss: 365.7181  ndcg: 0.0070
Early Stop!
Epoch  117  trn-loss: 392.4694  ndcg: 0.0066
Early Stop!
Epoch  118  trn-loss: 401.7626  ndcg: 0.0076
Early Stop!
Epoch  119  trn-loss: 385.0060  ndcg: 0.0078
src/main_edge_cur_rearrange.py:219: RuntimeWarning: invalid value encountered in divide
  recall = tmp / np.minimum(k, x_true_binary.sum(axis=1))
test:
Test NDCG@100=0.04142 (0.00015)
Test Recall@20=0.03962 (0.00022)
Test Recall@50=0.06953 (0.00029)