n =  381216
sizes of edges =  381216
batch_size =  635
0.1
src/main_edge_cur_babystep.py:206: RuntimeWarning: invalid value encountered in divide
  ndcg = dcg / idcg
Early Stop!
Epoch  0  trn-loss: 438.9708  ndcg: 0.0069
0.10825000000000001
Early Stop!
Epoch  1  trn-loss: 444.1429  ndcg: 0.0062
0.1165
Early Stop!
Epoch  2  trn-loss: 439.0466  ndcg: 0.0076
0.12475000000000001
Early Stop!
Epoch  3  trn-loss: 490.9100  ndcg: 0.0077
0.133
Early Stop!
Epoch  4  trn-loss: 439.3914  ndcg: 0.0083
0.14125000000000001
Early Stop!
Epoch  5  trn-loss: 432.3542  ndcg: 0.0080
0.14950000000000002
Early Stop!
Epoch  6  trn-loss: 419.6138  ndcg: 0.0080
0.15775
Early Stop!
Epoch  7  trn-loss: 452.3237  ndcg: 0.0087
0.166
Early Stop!
Epoch  8  trn-loss: 424.3301  ndcg: 0.0103
0.17425000000000002
Early Stop!
Epoch  9  trn-loss: 398.6820  ndcg: 0.0080
0.1825
Early Stop!
Epoch  10  trn-loss: 433.8318  ndcg: 0.0078
0.19075000000000003
Early Stop!
Epoch  11  trn-loss: 442.7847  ndcg: 0.0078
0.199
Early Stop!
Epoch  12  trn-loss: 412.7905  ndcg: 0.0072
0.20725000000000005
Early Stop!
Epoch  13  trn-loss: 427.3228  ndcg: 0.0068
0.21550000000000002
Early Stop!
Epoch  14  trn-loss: 412.1928  ndcg: 0.0070
0.22375
Early Stop!
Epoch  15  trn-loss: 438.5775  ndcg: 0.0091
0.232
Early Stop!
Epoch  16  trn-loss: 443.6583  ndcg: 0.0082
0.24025000000000002
Early Stop!
Epoch  17  trn-loss: 439.0803  ndcg: 0.0092
0.24850000000000003
Early Stop!
Epoch  18  trn-loss: 415.3672  ndcg: 0.0089
0.25675000000000003
Early Stop!
Epoch  19  trn-loss: 451.4491  ndcg: 0.0071
0.265
Early Stop!
Epoch  20  trn-loss: 413.4162  ndcg: 0.0085
0.27325000000000005
Early Stop!
Epoch  21  trn-loss: 403.4707  ndcg: 0.0084
0.28150000000000003
Early Stop!
Epoch  22  trn-loss: 417.5786  ndcg: 0.0080
0.28975
Early Stop!
Epoch  23  trn-loss: 427.3511  ndcg: 0.0084
0.29800000000000004
Early Stop!
Epoch  24  trn-loss: 420.3772  ndcg: 0.0078
0.30625
Early Stop!
Epoch  25  trn-loss: 454.6933  ndcg: 0.0060
0.31450000000000006
Early Stop!
Epoch  26  trn-loss: 398.9510  ndcg: 0.0078
0.32275000000000004
Early Stop!
Epoch  27  trn-loss: 432.3806  ndcg: 0.0063
0.331
Early Stop!
Epoch  28  trn-loss: 419.5466  ndcg: 0.0073
0.33925000000000005
Early Stop!
Epoch  29  trn-loss: 416.5757  ndcg: 0.0071
0.34750000000000003
Early Stop!
Epoch  30  trn-loss: 448.2398  ndcg: 0.0083
0.35575
Early Stop!
Epoch  31  trn-loss: 450.9734  ndcg: 0.0073
0.364
Early Stop!
Epoch  32  trn-loss: 432.9776  ndcg: 0.0066
0.3722500000000001
Early Stop!
Epoch  33  trn-loss: 432.4955  ndcg: 0.0067
0.38050000000000006
Early Stop!
Epoch  34  trn-loss: 425.6641  ndcg: 0.0072
0.38875000000000004
Early Stop!
Epoch  35  trn-loss: 401.9862  ndcg: 0.0084
0.397
Early Stop!
Epoch  36  trn-loss: 415.1621  ndcg: 0.0082
0.4052500000000001
Early Stop!
Epoch  37  trn-loss: 383.9038  ndcg: 0.0077
0.4135000000000001
Early Stop!
Epoch  38  trn-loss: 395.3183  ndcg: 0.0074
0.42175000000000007
Early Stop!
Epoch  39  trn-loss: 406.9500  ndcg: 0.0081
0.43000000000000005
Early Stop!
Epoch  40  trn-loss: 441.8239  ndcg: 0.0066
0.43825000000000003
Early Stop!
Epoch  41  trn-loss: 411.2886  ndcg: 0.0072
0.4465000000000001
Early Stop!
Epoch  42  trn-loss: 421.1442  ndcg: 0.0075
0.4547500000000001
Early Stop!
Epoch  43  trn-loss: 414.1710  ndcg: 0.0067
0.4630000000000001
Early Stop!
Epoch  44  trn-loss: 424.6866  ndcg: 0.0075
0.47125000000000006
Early Stop!
Epoch  45  trn-loss: 426.8441  ndcg: 0.0087
0.47950000000000004
Early Stop!
Epoch  46  trn-loss: 416.0842  ndcg: 0.0075
0.48775000000000013
Early Stop!
Epoch  47  trn-loss: 412.0524  ndcg: 0.0084
0.4960000000000001
Early Stop!
Epoch  48  trn-loss: 411.7998  ndcg: 0.0081
0.5042500000000001
Early Stop!
Epoch  49  trn-loss: 435.0225  ndcg: 0.0072
0.5125000000000001
Early Stop!
Epoch  50  trn-loss: 404.7385  ndcg: 0.0079
0.52075
Early Stop!
Epoch  51  trn-loss: 410.8807  ndcg: 0.0067
0.5290000000000001
Early Stop!
Epoch  52  trn-loss: 419.5619  ndcg: 0.0079
0.5372500000000001
Early Stop!
Epoch  53  trn-loss: 410.7119  ndcg: 0.0083
0.5455000000000001
Early Stop!
Epoch  54  trn-loss: 410.0106  ndcg: 0.0075
0.5537500000000001
Early Stop!
Epoch  55  trn-loss: 421.2162  ndcg: 0.0064
0.562
Early Stop!
Epoch  56  trn-loss: 385.6057  ndcg: 0.0077
0.5702500000000001
Early Stop!
Epoch  57  trn-loss: 417.5525  ndcg: 0.0077
0.5785000000000001
Early Stop!
Epoch  58  trn-loss: 437.5971  ndcg: 0.0074
0.5867500000000001
Early Stop!
Epoch  59  trn-loss: 423.9529  ndcg: 0.0068
0.5950000000000001
Early Stop!
Epoch  60  trn-loss: 424.0049  ndcg: 0.0078
0.6032500000000001
Early Stop!
Epoch  61  trn-loss: 434.2514  ndcg: 0.0077
0.6115
Early Stop!
Epoch  62  trn-loss: 403.7026  ndcg: 0.0077
0.61975
Early Stop!
Epoch  63  trn-loss: 393.7471  ndcg: 0.0079
0.628
Early Stop!
Epoch  64  trn-loss: 375.3180  ndcg: 0.0072
0.63625
Early Stop!
Epoch  65  trn-loss: 415.8534  ndcg: 0.0083
0.6445000000000001
Early Stop!
Epoch  66  trn-loss: 393.5887  ndcg: 0.0079
0.65275
Early Stop!
Epoch  67  trn-loss: 410.4684  ndcg: 0.0076
0.661
Early Stop!
Epoch  68  trn-loss: 406.6005  ndcg: 0.0069
0.66925
Early Stop!
Epoch  69  trn-loss: 392.9684  ndcg: 0.0068
0.6775
Early Stop!
Epoch  70  trn-loss: 408.2513  ndcg: 0.0084
0.6857500000000001
Early Stop!
Epoch  71  trn-loss: 409.8720  ndcg: 0.0080
0.6940000000000001
Early Stop!
Epoch  72  trn-loss: 405.7641  ndcg: 0.0075
0.70225
Early Stop!
Epoch  73  trn-loss: 430.5706  ndcg: 0.0075
0.7105000000000001
Early Stop!
Epoch  74  trn-loss: 411.8229  ndcg: 0.0069
0.71875
Early Stop!
Epoch  75  trn-loss: 404.4427  ndcg: 0.0082
0.7270000000000001
Early Stop!
Epoch  76  trn-loss: 423.4528  ndcg: 0.0071
0.7352500000000001
Early Stop!
Epoch  77  trn-loss: 392.3893  ndcg: 0.0082
0.7435
Early Stop!
Epoch  78  trn-loss: 420.3468  ndcg: 0.0072
0.7517500000000001
Early Stop!
Epoch  79  trn-loss: 408.3036  ndcg: 0.0098
0.76
Early Stop!
Epoch  80  trn-loss: 420.1529  ndcg: 0.0073
0.7682500000000001
Early Stop!
Epoch  81  trn-loss: 429.6466  ndcg: 0.0078
0.7765000000000001
Early Stop!
Epoch  82  trn-loss: 393.1067  ndcg: 0.0072
0.7847500000000001
Early Stop!
Epoch  83  trn-loss: 394.3188  ndcg: 0.0092
0.7930000000000001
Early Stop!
Epoch  84  trn-loss: 397.3746  ndcg: 0.0081
0.80125
Early Stop!
Epoch  85  trn-loss: 389.5040  ndcg: 0.0072
0.8095000000000001
Early Stop!
Epoch  86  trn-loss: 378.5976  ndcg: 0.0083
0.81775
Early Stop!
Epoch  87  trn-loss: 404.3700  ndcg: 0.0084
0.8260000000000001
Early Stop!
Epoch  88  trn-loss: 403.4578  ndcg: 0.0073
0.8342500000000002
Early Stop!
Epoch  89  trn-loss: 406.8517  ndcg: 0.0065
0.8425
Early Stop!
Epoch  90  trn-loss: 402.8417  ndcg: 0.0080
0.8507500000000001
Early Stop!
Epoch  91  trn-loss: 381.6632  ndcg: 0.0085
0.859
Early Stop!
Epoch  92  trn-loss: 407.1067  ndcg: 0.0069
0.8672500000000001
Early Stop!
Epoch  93  trn-loss: 416.8411  ndcg: 0.0087
0.8755000000000002
Early Stop!
Epoch  94  trn-loss: 407.1144  ndcg: 0.0073
0.88375
Early Stop!
Epoch  95  trn-loss: 417.6555  ndcg: 0.0075
0.8920000000000001
Early Stop!
Epoch  96  trn-loss: 392.2167  ndcg: 0.0079
0.90025
Early Stop!
Epoch  97  trn-loss: 398.5728  ndcg: 0.0060
0.9085000000000001
Early Stop!
Epoch  98  trn-loss: 418.8359  ndcg: 0.0073
0.9167500000000002
Early Stop!
Epoch  99  trn-loss: 396.3833  ndcg: 0.0071
0.925
Early Stop!
Epoch  100  trn-loss: 419.8254  ndcg: 0.0079
0.9332500000000001
Early Stop!
Epoch  101  trn-loss: 389.0360  ndcg: 0.0080
0.9415
Early Stop!
Epoch  102  trn-loss: 404.5821  ndcg: 0.0084
0.9497500000000001
Early Stop!
Epoch  103  trn-loss: 401.9756  ndcg: 0.0071
0.9580000000000002
Early Stop!
Epoch  104  trn-loss: 387.2070  ndcg: 0.0081
0.96625
Early Stop!
Epoch  105  trn-loss: 400.9616  ndcg: 0.0059
0.9745000000000001
Early Stop!
Epoch  106  trn-loss: 395.3933  ndcg: 0.0081
0.98275
Early Stop!
Epoch  107  trn-loss: 409.9655  ndcg: 0.0069
0.9910000000000001
Early Stop!
Epoch  108  trn-loss: 396.4338  ndcg: 0.0080
0.9992500000000002
Early Stop!
Epoch  109  trn-loss: 384.8195  ndcg: 0.0067
1
Early Stop!
Epoch  110  trn-loss: 407.9854  ndcg: 0.0081
1
Early Stop!
Epoch  111  trn-loss: 375.8857  ndcg: 0.0073
1
Early Stop!
Epoch  112  trn-loss: 407.7564  ndcg: 0.0082
1
Early Stop!
Epoch  113  trn-loss: 416.0422  ndcg: 0.0076
1
Early Stop!
Epoch  114  trn-loss: 418.8629  ndcg: 0.0075
1
Early Stop!
Epoch  115  trn-loss: 411.1717  ndcg: 0.0076
1
Early Stop!
Epoch  116  trn-loss: 398.6180  ndcg: 0.0070
1
Early Stop!
Epoch  117  trn-loss: 424.9609  ndcg: 0.0080
1
Early Stop!
Epoch  118  trn-loss: 408.2072  ndcg: 0.0078
1
Early Stop!
Epoch  119  trn-loss: 424.2241  ndcg: 0.0066
src/main_edge_cur_babystep.py:221: RuntimeWarning: invalid value encountered in divide
  recall = tmp / np.minimum(k, x_true_binary.sum(axis=1))
test:
Test NDCG@100=0.04966 (0.00011)
Test Recall@20=0.04474 (0.00016)
Test Recall@50=0.07471 (0.00021)
