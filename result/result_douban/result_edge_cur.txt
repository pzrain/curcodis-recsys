n =  25185
sizes of edges =  25185
batch_size =  6296
main_edge_cur.py:203: RuntimeWarning: invalid value encountered in true_divide
  ndcg = dcg / idcg
Epoch  0  trn-loss: 0.0039  ndcg: 0.0000
Epoch  1  trn-loss: 0.0227  ndcg: 0.0132
Epoch  2  trn-loss: 0.0092  ndcg: 0.0484
Epoch  3  trn-loss: 0.0096  ndcg: 0.0586
Epoch  4  trn-loss: 663.8024  ndcg: 0.0379
Epoch  5  trn-loss: 225.6071  ndcg: 0.0521
Epoch  6  trn-loss: 153.7079  ndcg: 0.0522
Epoch  7  trn-loss: 1.7896  ndcg: 0.0605
Epoch  8  trn-loss: 0.0514  ndcg: 0.1224
Epoch  9  trn-loss: 0.0586  ndcg: 0.0152
Epoch  10  trn-loss: 0.0495  ndcg: 0.0380
Epoch  11  trn-loss: 0.0453  ndcg: 0.0594
Epoch  12  trn-loss: 3.5736  ndcg: 0.0000
Early Stop!
Epoch  13  trn-loss: 97.1831  ndcg: 0.0440
Early Stop!
Epoch  14  trn-loss: 100.5328  ndcg: 0.0437
Early Stop!
Epoch  15  trn-loss: 112.6685  ndcg: 0.0422
Early Stop!
Epoch  16  trn-loss: 115.7486  ndcg: 0.0438
Early Stop!
Epoch  17  trn-loss: 125.8395  ndcg: 0.0430
Early Stop!
Epoch  18  trn-loss: 129.2716  ndcg: 0.0422
Early Stop!
Epoch  19  trn-loss: 128.5977  ndcg: 0.0396
Early Stop!
Epoch  20  trn-loss: 137.7637  ndcg: 0.0407
Early Stop!
Epoch  21  trn-loss: 147.2266  ndcg: 0.0402
Early Stop!
Epoch  22  trn-loss: 153.7375  ndcg: 0.0412
Early Stop!
Epoch  23  trn-loss: 166.8814  ndcg: 0.0408
Early Stop!
Epoch  24  trn-loss: 168.4510  ndcg: 0.0407
Early Stop!
Epoch  25  trn-loss: 171.5886  ndcg: 0.0408
Early Stop!
Epoch  26  trn-loss: 176.5436  ndcg: 0.0410
Early Stop!
Epoch  27  trn-loss: 185.8184  ndcg: 0.0410
Early Stop!
Epoch  28  trn-loss: 197.5258  ndcg: 0.0408
Early Stop!
Epoch  29  trn-loss: 202.0376  ndcg: 0.0396
Early Stop!
Epoch  30  trn-loss: 210.2137  ndcg: 0.0392
Early Stop!
Epoch  31  trn-loss: 225.7586  ndcg: 0.0401
Early Stop!
Epoch  32  trn-loss: 229.3258  ndcg: 0.0399
Early Stop!
Epoch  33  trn-loss: 239.1268  ndcg: 0.0395
Early Stop!
Epoch  34  trn-loss: 240.0469  ndcg: 0.0395
Early Stop!
Epoch  35  trn-loss: 256.4059  ndcg: 0.0404
Early Stop!
Epoch  36  trn-loss: 260.3507  ndcg: 0.0395
Early Stop!
Epoch  37  trn-loss: 273.6614  ndcg: 0.0399
Early Stop!
Epoch  38  trn-loss: 290.5528  ndcg: 0.0399
Early Stop!
Epoch  39  trn-loss: 296.0974  ndcg: 0.0394
Early Stop!
Epoch  40  trn-loss: 304.1155  ndcg: 0.0404
Early Stop!
Epoch  41  trn-loss: 313.3291  ndcg: 0.0392
Early Stop!
Epoch  42  trn-loss: 320.1954  ndcg: 0.0386
Early Stop!
Epoch  43  trn-loss: 336.3636  ndcg: 0.0390
Early Stop!
Epoch  44  trn-loss: 353.1273  ndcg: 0.0399
Early Stop!
Epoch  45  trn-loss: 362.5055  ndcg: 0.0401
Early Stop!
Epoch  46  trn-loss: 367.7612  ndcg: 0.0392
Early Stop!
Epoch  47  trn-loss: 382.7277  ndcg: 0.0386
Early Stop!
Epoch  48  trn-loss: 382.0903  ndcg: 0.0389
Early Stop!
Epoch  49  trn-loss: 411.0602  ndcg: 0.0385
Early Stop!
Epoch  50  trn-loss: 425.2765  ndcg: 0.0391
Early Stop!
Epoch  51  trn-loss: 430.2693  ndcg: 0.0386
Early Stop!
Epoch  52  trn-loss: 444.3496  ndcg: 0.0372
Early Stop!
Epoch  53  trn-loss: 473.8363  ndcg: 0.0386
Early Stop!
Epoch  54  trn-loss: 470.4297  ndcg: 0.0384
Early Stop!
Epoch  55  trn-loss: 479.7098  ndcg: 0.0399
Early Stop!
Epoch  56  trn-loss: 500.6310  ndcg: 0.0374
Early Stop!
Epoch  57  trn-loss: 511.0886  ndcg: 0.0375
Early Stop!
Epoch  58  trn-loss: 527.3863  ndcg: 0.0373
Early Stop!
Epoch  59  trn-loss: 551.2788  ndcg: 0.0389
Early Stop!
Epoch  60  trn-loss: 577.8139  ndcg: 0.0375
Early Stop!
Epoch  61  trn-loss: 604.2800  ndcg: 0.0370
Early Stop!
Epoch  62  trn-loss: 619.3768  ndcg: 0.0362
Early Stop!
Epoch  63  trn-loss: 635.4849  ndcg: 0.0375
Early Stop!
Epoch  64  trn-loss: 648.1046  ndcg: 0.0365
Early Stop!
Epoch  65  trn-loss: 670.5209  ndcg: 0.0384
Early Stop!
Epoch  66  trn-loss: 694.9652  ndcg: 0.0377
Early Stop!
Epoch  67  trn-loss: 717.7569  ndcg: 0.0369
Early Stop!
Epoch  68  trn-loss: 743.7015  ndcg: 0.0359
Early Stop!
Epoch  69  trn-loss: 753.0784  ndcg: 0.0358
Early Stop!
Epoch  70  trn-loss: 790.4523  ndcg: 0.0356
Early Stop!
Epoch  71  trn-loss: 807.2534  ndcg: 0.0371
Early Stop!
Epoch  72  trn-loss: 827.3079  ndcg: 0.0373
Early Stop!
Epoch  73  trn-loss: 844.9083  ndcg: 0.0371
Early Stop!
Epoch  74  trn-loss: 872.5097  ndcg: 0.0372
Early Stop!
Epoch  75  trn-loss: 900.9622  ndcg: 0.0367
Early Stop!
Epoch  76  trn-loss: 931.7320  ndcg: 0.0388
Early Stop!
Epoch  77  trn-loss: 956.8205  ndcg: 0.0361
Early Stop!
Epoch  78  trn-loss: 998.4601  ndcg: 0.0368
Early Stop!
Epoch  79  trn-loss: 1012.7568  ndcg: 0.0370
Early Stop!
Epoch  80  trn-loss: 1047.7244  ndcg: 0.0356
Early Stop!
Epoch  81  trn-loss: 1078.2191  ndcg: 0.0373
Early Stop!
Epoch  82  trn-loss: 1137.2111  ndcg: 0.0371
Early Stop!
Epoch  83  trn-loss: 1145.9590  ndcg: 0.0379
Early Stop!
Epoch  84  trn-loss: 1204.4875  ndcg: 0.0373
Early Stop!
Epoch  85  trn-loss: 1232.9401  ndcg: 0.0361
Early Stop!
Epoch  86  trn-loss: 1278.8438  ndcg: 0.0387
Early Stop!
Epoch  87  trn-loss: 1307.1343  ndcg: 0.0373
Early Stop!
Epoch  88  trn-loss: 1342.7433  ndcg: 0.0369
Early Stop!
Epoch  89  trn-loss: 1389.5426  ndcg: 0.0368
Early Stop!
Epoch  90  trn-loss: 1446.3763  ndcg: 0.0367
Early Stop!
Epoch  91  trn-loss: 1514.9490  ndcg: 0.0372
Early Stop!
Epoch  92  trn-loss: 1556.3348  ndcg: 0.0376
Early Stop!
Epoch  93  trn-loss: 1646.9902  ndcg: 0.0356
Early Stop!
Epoch  94  trn-loss: 1673.7267  ndcg: 0.0371
Early Stop!
Epoch  95  trn-loss: 1763.2042  ndcg: 0.0387
Early Stop!
Epoch  96  trn-loss: 1843.1614  ndcg: 0.0372
Early Stop!
Epoch  97  trn-loss: 1930.8448  ndcg: 0.0364
Early Stop!
Epoch  98  trn-loss: 2007.3706  ndcg: 0.0376
Early Stop!
Epoch  99  trn-loss: 2218.6516  ndcg: 0.0378
Early Stop!
Epoch  100  trn-loss: 2184.2500  ndcg: 0.0393
Early Stop!
Epoch  101  trn-loss: 2207.0408  ndcg: 0.0380
Early Stop!
Epoch  102  trn-loss: 2225.9985  ndcg: 0.0384
Early Stop!
Epoch  103  trn-loss: 2193.0618  ndcg: 0.0395
Early Stop!
Epoch  104  trn-loss: 2168.6030  ndcg: 0.0383
Early Stop!
Epoch  105  trn-loss: 2198.5017  ndcg: 0.0395
Early Stop!
Epoch  106  trn-loss: 2203.6274  ndcg: 0.0397
Early Stop!
Epoch  107  trn-loss: 2193.0117  ndcg: 0.0394
Early Stop!
Epoch  108  trn-loss: 2170.3223  ndcg: 0.0378
Early Stop!
Epoch  109  trn-loss: 2169.2363  ndcg: 0.0390
Early Stop!
Epoch  110  trn-loss: 2190.8418  ndcg: 0.0374
Early Stop!
Epoch  111  trn-loss: 2163.1714  ndcg: 0.0417
Early Stop!
Epoch  112  trn-loss: 2148.8154  ndcg: 0.0383
Early Stop!
Epoch  113  trn-loss: 2179.3066  ndcg: 0.0405
Early Stop!
Epoch  114  trn-loss: 2157.1953  ndcg: 0.0379
Early Stop!
Epoch  115  trn-loss: 2180.6541  ndcg: 0.0388
Early Stop!
Epoch  116  trn-loss: 2157.5862  ndcg: 0.0378
Early Stop!
Epoch  117  trn-loss: 2170.7363  ndcg: 0.0402
Early Stop!
Epoch  118  trn-loss: 2163.3389  ndcg: 0.0389
Early Stop!
Epoch  119  trn-loss: 2164.8828  ndcg: 0.0376
main_edge_cur.py:218: RuntimeWarning: invalid value encountered in true_divide
  recall = tmp / np.minimum(k, x_true_binary.sum(axis=1))
test:
Test NDCG@100=0.15237 (0.00126)
Test Recall@20=0.12789 (0.00160)
Test Recall@50=0.16657 (0.00187)
