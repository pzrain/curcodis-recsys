main.py:202: RuntimeWarning: invalid value encountered in true_divide
  ndcg = dcg / idcg
Epoch  0  trn-loss: 2291.6301  ndcg: 0.0351
Epoch  1  trn-loss: 2147.4172  ndcg: 0.0664
Epoch  2  trn-loss: 2280.2456  ndcg: 0.0713
Epoch  3  trn-loss: 1950.7819  ndcg: 0.0655
Epoch  4  trn-loss: 2194.4854  ndcg: 0.0807
Epoch  5  trn-loss: 2362.0454  ndcg: 0.0842
Epoch  6  trn-loss: 2231.6636  ndcg: 0.0897
Epoch  7  trn-loss: 1984.9058  ndcg: 0.1064
Epoch  8  trn-loss: 2176.5547  ndcg: 0.1096
Epoch  9  trn-loss: 2004.1592  ndcg: 0.1125
Epoch  10  trn-loss: 2111.6995  ndcg: 0.1186
Epoch  11  trn-loss: 2156.4922  ndcg: 0.1126
Epoch  12  trn-loss: 1849.3302  ndcg: 0.1109
Epoch  13  trn-loss: 2104.9324  ndcg: 0.1156
Epoch  14  trn-loss: 2225.9192  ndcg: 0.1217
Epoch  15  trn-loss: 2035.8724  ndcg: 0.1101
Epoch  16  trn-loss: 1950.3453  ndcg: 0.1176
Epoch  17  trn-loss: 1883.9353  ndcg: 0.1182
Epoch  18  trn-loss: 1961.7531  ndcg: 0.1237
Epoch  19  trn-loss: 1785.5321  ndcg: 0.1244
Epoch  20  trn-loss: 1937.3420  ndcg: 0.1205
Epoch  21  trn-loss: 2132.5806  ndcg: 0.1185
Epoch  22  trn-loss: 1818.3025  ndcg: 0.1207
Epoch  23  trn-loss: 1955.8903  ndcg: 0.1149
Epoch  24  trn-loss: 1955.4210  ndcg: 0.1360
Epoch  25  trn-loss: 1552.8915  ndcg: 0.1249
Epoch  26  trn-loss: 1919.3474  ndcg: 0.1202
Epoch  27  trn-loss: 1871.7797  ndcg: 0.1248
Epoch  28  trn-loss: 1950.4994  ndcg: 0.1214
Epoch  29  trn-loss: 1951.6046  ndcg: 0.1178
Epoch  30  trn-loss: 1971.3462  ndcg: 0.1320
Epoch  31  trn-loss: 2026.6165  ndcg: 0.1254
Early Stop!
Epoch  32  trn-loss: 1812.6852  ndcg: 0.1259
Early Stop!
Epoch  33  trn-loss: 2097.6492  ndcg: 0.1351
Early Stop!
Epoch  34  trn-loss: 1832.9231  ndcg: 0.1274
Early Stop!
Epoch  35  trn-loss: 2083.2256  ndcg: 0.1311
Early Stop!
Epoch  36  trn-loss: 1892.3618  ndcg: 0.1238
Early Stop!
Epoch  37  trn-loss: 1877.3890  ndcg: 0.1238
Early Stop!
Epoch  38  trn-loss: 1966.9304  ndcg: 0.1352
Early Stop!
Epoch  39  trn-loss: 1845.9310  ndcg: 0.1350
Early Stop!
Epoch  40  trn-loss: 2180.4521  ndcg: 0.1277
Early Stop!
Epoch  41  trn-loss: 1892.2111  ndcg: 0.1287
Early Stop!
Epoch  42  trn-loss: 2007.5914  ndcg: 0.1296
Early Stop!
Epoch  43  trn-loss: 2191.5432  ndcg: 0.1269
Early Stop!
Epoch  44  trn-loss: 1877.2794  ndcg: 0.1275
Early Stop!
Epoch  45  trn-loss: 1987.3267  ndcg: 0.1254
Epoch  46  trn-loss: 1866.3816  ndcg: 0.1320
Epoch  47  trn-loss: 1870.0222  ndcg: 0.1279
Epoch  48  trn-loss: 1982.5618  ndcg: 0.1337
Epoch  49  trn-loss: 1970.2804  ndcg: 0.1412
Epoch  50  trn-loss: 1772.5917  ndcg: 0.1321
Epoch  51  trn-loss: 1997.2070  ndcg: 0.1358
Epoch  52  trn-loss: 1997.2661  ndcg: 0.1339
Epoch  53  trn-loss: 1831.2117  ndcg: 0.1296
Early Stop!
Epoch  54  trn-loss: 1777.7861  ndcg: 0.1336
Early Stop!
Epoch  55  trn-loss: 1774.8533  ndcg: 0.1335
Early Stop!
Epoch  56  trn-loss: 1817.0154  ndcg: 0.1297
Early Stop!
Epoch  57  trn-loss: 2063.3230  ndcg: 0.1335
Early Stop!
Epoch  58  trn-loss: 1580.7266  ndcg: 0.1284
Early Stop!
Epoch  59  trn-loss: 1871.3424  ndcg: 0.1341
Early Stop!
Epoch  60  trn-loss: 1725.1630  ndcg: 0.1284
Early Stop!
Epoch  61  trn-loss: 2027.2985  ndcg: 0.1284
Early Stop!
Epoch  62  trn-loss: 1994.7999  ndcg: 0.1334
Early Stop!
Epoch  63  trn-loss: 1967.2629  ndcg: 0.1340
Early Stop!
Epoch  64  trn-loss: 1900.8313  ndcg: 0.1344
Early Stop!
Epoch  65  trn-loss: 2129.5483  ndcg: 0.1364
Early Stop!
Epoch  66  trn-loss: 1905.5546  ndcg: 0.1317
Early Stop!
Epoch  67  trn-loss: 1796.0045  ndcg: 0.1399
Early Stop!
Epoch  68  trn-loss: 2064.8738  ndcg: 0.1332
Early Stop!
Epoch  69  trn-loss: 1878.0281  ndcg: 0.1342
Early Stop!
Epoch  70  trn-loss: 2043.4333  ndcg: 0.1323
Early Stop!
Epoch  71  trn-loss: 2059.9358  ndcg: 0.1357
Early Stop!
Epoch  72  trn-loss: 1941.8542  ndcg: 0.1239
Early Stop!
Epoch  73  trn-loss: 2092.6592  ndcg: 0.1412
Early Stop!
Epoch  74  trn-loss: 1984.3090  ndcg: 0.1282
Epoch  75  trn-loss: 2145.0164  ndcg: 0.1388
Epoch  76  trn-loss: 1897.4771  ndcg: 0.1296
Epoch  77  trn-loss: 2050.6833  ndcg: 0.1341
Epoch  78  trn-loss: 1963.8763  ndcg: 0.1362
Early Stop!
Epoch  79  trn-loss: 1904.7198  ndcg: 0.1280
Epoch  80  trn-loss: 1724.9028  ndcg: 0.1308
Epoch  81  trn-loss: 1783.4786  ndcg: 0.1401
Epoch  82  trn-loss: 1881.9562  ndcg: 0.1303
Epoch  83  trn-loss: 1944.8457  ndcg: 0.1281
Early Stop!
Epoch  84  trn-loss: 1850.5236  ndcg: 0.1321
Early Stop!
Epoch  85  trn-loss: 1960.4027  ndcg: 0.1381
Early Stop!
Epoch  86  trn-loss: 1831.4857  ndcg: 0.1311
Early Stop!
Epoch  87  trn-loss: 1601.7682  ndcg: 0.1275
Early Stop!
Epoch  88  trn-loss: 1944.5385  ndcg: 0.1405
Early Stop!
Epoch  89  trn-loss: 2022.6454  ndcg: 0.1408
Early Stop!
Epoch  90  trn-loss: 1912.5823  ndcg: 0.1283
Early Stop!
Epoch  91  trn-loss: 1923.9054  ndcg: 0.1240
Epoch  92  trn-loss: 1954.7147  ndcg: 0.1329
Epoch  93  trn-loss: 2039.5204  ndcg: 0.1422
Epoch  94  trn-loss: 1582.2136  ndcg: 0.1359
Epoch  95  trn-loss: 2086.6465  ndcg: 0.1344
Early Stop!
Epoch  96  trn-loss: 1621.7585  ndcg: 0.1262
Early Stop!
Epoch  97  trn-loss: 2014.5511  ndcg: 0.1326
Early Stop!
Epoch  98  trn-loss: 1930.1241  ndcg: 0.1336
Early Stop!
Epoch  99  trn-loss: 1906.7153  ndcg: 0.1384
Early Stop!
Epoch  100  trn-loss: 1978.2208  ndcg: 0.1264
Early Stop!
Epoch  101  trn-loss: 1775.4967  ndcg: 0.1303
Early Stop!
Epoch  102  trn-loss: 1937.9788  ndcg: 0.1367
Early Stop!
Epoch  103  trn-loss: 1855.6251  ndcg: 0.1323
Early Stop!
Epoch  104  trn-loss: 1735.5260  ndcg: 0.1338
Early Stop!
Epoch  105  trn-loss: 1833.8246  ndcg: 0.1366
Early Stop!
Epoch  106  trn-loss: 1953.1949  ndcg: 0.1296
Early Stop!
Epoch  107  trn-loss: 1755.3582  ndcg: 0.1353
Early Stop!
Epoch  108  trn-loss: 1958.2990  ndcg: 0.1383
Early Stop!
Epoch  109  trn-loss: 1994.0806  ndcg: 0.1378
Early Stop!
Epoch  110  trn-loss: 1738.2731  ndcg: 0.1241
Early Stop!
Epoch  111  trn-loss: 1709.0582  ndcg: 0.1349
Early Stop!
Epoch  112  trn-loss: 1829.2917  ndcg: 0.1377
Early Stop!
Epoch  113  trn-loss: 1917.1267  ndcg: 0.1289
Early Stop!
Epoch  114  trn-loss: 2080.3796  ndcg: 0.1314
Early Stop!
Epoch  115  trn-loss: 1971.7991  ndcg: 0.1404
Early Stop!
Epoch  116  trn-loss: 1957.8732  ndcg: 0.1339
Early Stop!
Epoch  117  trn-loss: 1954.9667  ndcg: 0.1333
Early Stop!
Epoch  118  trn-loss: 1943.2761  ndcg: 0.1305
Early Stop!
Epoch  119  trn-loss: 1962.7864  ndcg: 0.1322
Early Stop!
Epoch  120  trn-loss: 2232.1736  ndcg: 0.1403
Early Stop!
Epoch  121  trn-loss: 1947.0176  ndcg: 0.1370
Early Stop!
Epoch  122  trn-loss: 2156.8850  ndcg: 0.1396
Early Stop!
Epoch  123  trn-loss: 1849.6422  ndcg: 0.1295
Early Stop!
Epoch  124  trn-loss: 1800.6163  ndcg: 0.1340
Early Stop!
Epoch  125  trn-loss: 2004.6482  ndcg: 0.1237
Early Stop!
Epoch  126  trn-loss: 1780.1371  ndcg: 0.1353
Early Stop!
Epoch  127  trn-loss: 1769.7520  ndcg: 0.1323
Early Stop!
Epoch  128  trn-loss: 1930.6858  ndcg: 0.1349
Early Stop!
Epoch  129  trn-loss: 1958.7972  ndcg: 0.1256
Early Stop!
Epoch  130  trn-loss: 1832.3821  ndcg: 0.1345
Early Stop!
Epoch  131  trn-loss: 1945.9606  ndcg: 0.1312
Early Stop!
Epoch  132  trn-loss: 1910.1748  ndcg: 0.1315
Early Stop!
Epoch  133  trn-loss: 1779.3051  ndcg: 0.1295
Early Stop!
Epoch  134  trn-loss: 1874.4823  ndcg: 0.1306
Early Stop!
Epoch  135  trn-loss: 1972.2728  ndcg: 0.1309
Early Stop!
Epoch  136  trn-loss: 1880.7240  ndcg: 0.1410
Early Stop!
Epoch  137  trn-loss: 2096.1304  ndcg: 0.1396
Early Stop!
Epoch  138  trn-loss: 1828.0187  ndcg: 0.1329
Early Stop!
Epoch  139  trn-loss: 1906.0779  ndcg: 0.1283
Early Stop!
Epoch  140  trn-loss: 1714.4700  ndcg: 0.1284
Early Stop!
Epoch  141  trn-loss: 2042.2288  ndcg: 0.1438
Early Stop!
Epoch  142  trn-loss: 2054.4614  ndcg: 0.1337
Early Stop!
Epoch  143  trn-loss: 1937.5314  ndcg: 0.1323
Early Stop!
Epoch  144  trn-loss: 1869.3013  ndcg: 0.1289
Early Stop!
Epoch  145  trn-loss: 2065.5537  ndcg: 0.1381
Early Stop!
Epoch  146  trn-loss: 1929.7917  ndcg: 0.1381
Early Stop!
Epoch  147  trn-loss: 1823.8959  ndcg: 0.1268
Early Stop!
Epoch  148  trn-loss: 1860.9438  ndcg: 0.1321
Early Stop!
Epoch  149  trn-loss: 1830.6276  ndcg: 0.1466
Early Stop!
Epoch  150  trn-loss: 1840.0066  ndcg: 0.1315
Early Stop!
Epoch  151  trn-loss: 1967.3713  ndcg: 0.1371
Early Stop!
Epoch  152  trn-loss: 1856.6318  ndcg: 0.1315
Early Stop!
Epoch  153  trn-loss: 2050.7129  ndcg: 0.1360
Early Stop!
Epoch  154  trn-loss: 1621.2173  ndcg: 0.1270
Early Stop!
Epoch  155  trn-loss: 1900.8877  ndcg: 0.1268
Early Stop!
Epoch  156  trn-loss: 1953.8236  ndcg: 0.1449
Early Stop!
Epoch  157  trn-loss: 1955.1748  ndcg: 0.1355
Early Stop!
Epoch  158  trn-loss: 1886.9874  ndcg: 0.1350
Early Stop!
Epoch  159  trn-loss: 2082.2693  ndcg: 0.1341
Early Stop!
Epoch  160  trn-loss: 1923.0366  ndcg: 0.1317
Early Stop!
Epoch  161  trn-loss: 1809.2128  ndcg: 0.1331
Early Stop!
Epoch  162  trn-loss: 2046.5289  ndcg: 0.1342
Early Stop!
Epoch  163  trn-loss: 2002.8258  ndcg: 0.1353
Early Stop!
Epoch  164  trn-loss: 1927.4275  ndcg: 0.1337
Early Stop!
Epoch  165  trn-loss: 1732.7494  ndcg: 0.1374
Early Stop!
Epoch  166  trn-loss: 1935.7343  ndcg: 0.1465
Early Stop!
Epoch  167  trn-loss: 2040.5338  ndcg: 0.1317
Early Stop!
Epoch  168  trn-loss: 1929.2256  ndcg: 0.1387
Early Stop!
Epoch  169  trn-loss: 1847.3019  ndcg: 0.1283
Early Stop!
Epoch  170  trn-loss: 1842.5768  ndcg: 0.1328
Early Stop!
Epoch  171  trn-loss: 1869.5634  ndcg: 0.1311
Early Stop!
Epoch  172  trn-loss: 1962.7413  ndcg: 0.1327
Early Stop!
Epoch  173  trn-loss: 1913.4424  ndcg: 0.1360
Early Stop!
Epoch  174  trn-loss: 2025.6697  ndcg: 0.1424
Early Stop!
Epoch  175  trn-loss: 1836.9651  ndcg: 0.1309
Early Stop!
Epoch  176  trn-loss: 2088.7117  ndcg: 0.1326
Early Stop!
Epoch  177  trn-loss: 2089.4893  ndcg: 0.1294
Early Stop!
Epoch  178  trn-loss: 1991.0970  ndcg: 0.1384
Early Stop!
Epoch  179  trn-loss: 1800.7728  ndcg: 0.1309
Early Stop!
Epoch  180  trn-loss: 1984.7063  ndcg: 0.1353
Early Stop!
Epoch  181  trn-loss: 1848.1174  ndcg: 0.1345
Early Stop!
Epoch  182  trn-loss: 2001.5642  ndcg: 0.1390
Early Stop!
Epoch  183  trn-loss: 1836.6578  ndcg: 0.1349
Early Stop!
Epoch  184  trn-loss: 2055.6533  ndcg: 0.1323
Early Stop!
Epoch  185  trn-loss: 1921.0211  ndcg: 0.1359
Early Stop!
Epoch  186  trn-loss: 2020.5664  ndcg: 0.1440
Early Stop!
Epoch  187  trn-loss: 2005.2081  ndcg: 0.1353
Early Stop!
Epoch  188  trn-loss: 2126.0281  ndcg: 0.1415
Early Stop!
Epoch  189  trn-loss: 1882.8519  ndcg: 0.1422
Early Stop!
Epoch  190  trn-loss: 1949.3708  ndcg: 0.1289
Early Stop!
Epoch  191  trn-loss: 2086.5745  ndcg: 0.1363
Early Stop!
Epoch  192  trn-loss: 1754.3562  ndcg: 0.1290
Early Stop!
Epoch  193  trn-loss: 2022.6570  ndcg: 0.1374
Early Stop!
Epoch  194  trn-loss: 2130.9780  ndcg: 0.1302
Early Stop!
Epoch  195  trn-loss: 1940.4617  ndcg: 0.1293
Early Stop!
Epoch  196  trn-loss: 1828.8096  ndcg: 0.1287
Early Stop!
Epoch  197  trn-loss: 1881.2827  ndcg: 0.1422
Early Stop!
Epoch  198  trn-loss: 1812.7635  ndcg: 0.1286
Early Stop!
Epoch  199  trn-loss: 2008.7933  ndcg: 0.1370
Early Stop!
Epoch  200  trn-loss: 1846.1237  ndcg: 0.1340
Early Stop!
Epoch  201  trn-loss: 1915.5089  ndcg: 0.1324
Early Stop!
Epoch  202  trn-loss: 1798.4885  ndcg: 0.1363
Early Stop!
Epoch  203  trn-loss: 1751.8978  ndcg: 0.1321
Early Stop!
Epoch  204  trn-loss: 1918.3293  ndcg: 0.1370
Early Stop!
Epoch  205  trn-loss: 1941.3948  ndcg: 0.1303
Early Stop!
Epoch  206  trn-loss: 2004.8754  ndcg: 0.1369
Early Stop!
Epoch  207  trn-loss: 1751.3446  ndcg: 0.1380
Early Stop!
Epoch  208  trn-loss: 1848.6100  ndcg: 0.1352
Early Stop!
Epoch  209  trn-loss: 1883.4816  ndcg: 0.1348
Early Stop!
Epoch  210  trn-loss: 1967.8864  ndcg: 0.1376
Early Stop!
Epoch  211  trn-loss: 1839.3457  ndcg: 0.1417
Early Stop!
Epoch  212  trn-loss: 2018.6731  ndcg: 0.1338
Early Stop!
Epoch  213  trn-loss: 1716.0791  ndcg: 0.1358
Early Stop!
Epoch  214  trn-loss: 1958.3031  ndcg: 0.1318
Early Stop!
Epoch  215  trn-loss: 1930.6082  ndcg: 0.1397
Early Stop!
Epoch  216  trn-loss: 1995.8151  ndcg: 0.1364
Early Stop!
Epoch  217  trn-loss: 1762.0579  ndcg: 0.1351
Early Stop!
Epoch  218  trn-loss: 1801.4458  ndcg: 0.1268
Early Stop!
Epoch  219  trn-loss: 1705.1108  ndcg: 0.1329
Early Stop!
Epoch  220  trn-loss: 2028.9698  ndcg: 0.1301
Early Stop!
Epoch  221  trn-loss: 2083.3235  ndcg: 0.1342
Early Stop!
Epoch  222  trn-loss: 1858.1738  ndcg: 0.1372
Early Stop!
Epoch  223  trn-loss: 1969.3389  ndcg: 0.1367
Early Stop!
Epoch  224  trn-loss: 1793.0986  ndcg: 0.1306
Early Stop!
Epoch  225  trn-loss: 1781.9469  ndcg: 0.1354
Early Stop!
Epoch  226  trn-loss: 1605.8628  ndcg: 0.1349
Early Stop!
Epoch  227  trn-loss: 1932.6915  ndcg: 0.1338
Early Stop!
Epoch  228  trn-loss: 1935.9906  ndcg: 0.1353
Early Stop!
Epoch  229  trn-loss: 2015.7717  ndcg: 0.1384
Early Stop!
Epoch  230  trn-loss: 1806.2919  ndcg: 0.1422
Early Stop!
Epoch  231  trn-loss: 1990.0480  ndcg: 0.1436
Early Stop!
Epoch  232  trn-loss: 1788.6396  ndcg: 0.1362
