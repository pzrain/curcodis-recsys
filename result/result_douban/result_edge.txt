n =  25185
sizes of edges =  25185
batch_size =  2518
main_edge.py:202: RuntimeWarning: invalid value encountered in true_divide
  ndcg = dcg / idcg
Epoch  0  trn-loss: 2891.7173  ndcg: 0.0866
Epoch  1  trn-loss: 2298.5381  ndcg: 0.0653
Early Stop!
Epoch  2  trn-loss: 2549.7454  ndcg: 0.0409
Early Stop!
Epoch  3  trn-loss: 2488.7471  ndcg: 0.0399
Early Stop!
Epoch  4  trn-loss: 2511.5378  ndcg: 0.0400
Early Stop!
Epoch  5  trn-loss: 2433.3120  ndcg: 0.0388
Early Stop!
Epoch  6  trn-loss: 2461.6807  ndcg: 0.0381
Early Stop!
Epoch  7  trn-loss: 2489.8750  ndcg: 0.0382
Early Stop!
Epoch  8  trn-loss: 2499.0020  ndcg: 0.0373
Early Stop!
Epoch  9  trn-loss: 2453.7981  ndcg: 0.0377
Early Stop!
Epoch  10  trn-loss: 2414.1721  ndcg: 0.0375
Early Stop!
Epoch  11  trn-loss: 2469.1853  ndcg: 0.0400
Early Stop!
Epoch  12  trn-loss: 2398.5454  ndcg: 0.0385
Early Stop!
Epoch  13  trn-loss: 2492.4250  ndcg: 0.0376
Early Stop!
Epoch  14  trn-loss: 2409.7427  ndcg: 0.0409
Early Stop!
Epoch  15  trn-loss: 2494.5740  ndcg: 0.0389
Early Stop!
Epoch  16  trn-loss: 2419.7354  ndcg: 0.0385
Early Stop!
Epoch  17  trn-loss: 2405.0251  ndcg: 0.0403
Early Stop!
Epoch  18  trn-loss: 2442.3464  ndcg: 0.0396
Early Stop!
Epoch  19  trn-loss: 2402.7239  ndcg: 0.0361
Early Stop!
Epoch  20  trn-loss: 2415.7717  ndcg: 0.0374
Early Stop!
Epoch  21  trn-loss: 2425.3086  ndcg: 0.0381
Early Stop!
Epoch  22  trn-loss: 2442.2122  ndcg: 0.0391
Early Stop!
Epoch  23  trn-loss: 2418.4851  ndcg: 0.0378
Early Stop!
Epoch  24  trn-loss: 2422.9509  ndcg: 0.0396
Early Stop!
Epoch  25  trn-loss: 2366.6226  ndcg: 0.0397
Early Stop!
Epoch  26  trn-loss: 2429.5999  ndcg: 0.0370
Early Stop!
Epoch  27  trn-loss: 2370.0728  ndcg: 0.0393
Early Stop!
Epoch  28  trn-loss: 2395.9172  ndcg: 0.0394
Early Stop!
Epoch  29  trn-loss: 2415.2637  ndcg: 0.0364
Early Stop!
Epoch  30  trn-loss: 2377.5396  ndcg: 0.0377
Early Stop!
Epoch  31  trn-loss: 2424.5718  ndcg: 0.0365
Early Stop!
Epoch  32  trn-loss: 2384.6443  ndcg: 0.0383
Early Stop!
Epoch  33  trn-loss: 2401.0156  ndcg: 0.0367
Early Stop!
Epoch  34  trn-loss: 2411.0225  ndcg: 0.0366
Early Stop!
Epoch  35  trn-loss: 2410.9360  ndcg: 0.0365
Early Stop!
Epoch  36  trn-loss: 2412.6438  ndcg: 0.0389
Early Stop!
Epoch  37  trn-loss: 2400.1245  ndcg: 0.0386
Early Stop!
Epoch  38  trn-loss: 2388.9021  ndcg: 0.0355
Early Stop!
Epoch  39  trn-loss: 2360.0718  ndcg: 0.0393
Early Stop!
Epoch  40  trn-loss: 2387.5244  ndcg: 0.0388
Early Stop!
Epoch  41  trn-loss: 2428.3440  ndcg: 0.0387
Early Stop!
Epoch  42  trn-loss: 2373.5186  ndcg: 0.0375
Early Stop!
Epoch  43  trn-loss: 2361.8696  ndcg: 0.0379
Early Stop!
Epoch  44  trn-loss: 2343.5120  ndcg: 0.0360
Early Stop!
Epoch  45  trn-loss: 2368.0110  ndcg: 0.0396
Early Stop!
Epoch  46  trn-loss: 2373.5039  ndcg: 0.0386
Early Stop!
Epoch  47  trn-loss: 2323.5127  ndcg: 0.0367
Early Stop!
Epoch  48  trn-loss: 2341.3245  ndcg: 0.0373
Early Stop!
Epoch  49  trn-loss: 2354.1589  ndcg: 0.0380
Early Stop!
Epoch  50  trn-loss: 2307.9590  ndcg: 0.0370
Early Stop!
Epoch  51  trn-loss: 2291.7913  ndcg: 0.0386
Early Stop!
Epoch  52  trn-loss: 2403.7214  ndcg: 0.0373
Early Stop!
Epoch  53  trn-loss: 2417.1218  ndcg: 0.0370
Early Stop!
Epoch  54  trn-loss: 2391.4368  ndcg: 0.0389
Early Stop!
Epoch  55  trn-loss: 2350.3374  ndcg: 0.0375
Early Stop!
Epoch  56  trn-loss: 2377.7085  ndcg: 0.0380
Early Stop!
Epoch  57  trn-loss: 2356.0894  ndcg: 0.0378
Early Stop!
Epoch  58  trn-loss: 2313.1895  ndcg: 0.0386
Early Stop!
Epoch  59  trn-loss: 2335.5393  ndcg: 0.0384
Early Stop!
Epoch  60  trn-loss: 2321.0310  ndcg: 0.0377
Early Stop!
Epoch  61  trn-loss: 2404.2234  ndcg: 0.0348
Early Stop!
Epoch  62  trn-loss: 2322.8203  ndcg: 0.0362
Early Stop!
Epoch  63  trn-loss: 2308.6682  ndcg: 0.0380
Early Stop!
Epoch  64  trn-loss: 2363.5208  ndcg: 0.0370
Early Stop!
Epoch  65  trn-loss: 2323.1106  ndcg: 0.0374
Early Stop!
Epoch  66  trn-loss: 2356.8872  ndcg: 0.0381
Early Stop!
Epoch  67  trn-loss: 2342.8079  ndcg: 0.0384
Early Stop!
Epoch  68  trn-loss: 2390.9619  ndcg: 0.0355
Early Stop!
Epoch  69  trn-loss: 2381.4814  ndcg: 0.0388
Early Stop!
Epoch  70  trn-loss: 2350.9282  ndcg: 0.0368
Early Stop!
Epoch  71  trn-loss: 2364.4221  ndcg: 0.0396
Early Stop!
Epoch  72  trn-loss: 2342.1377  ndcg: 0.0369
Early Stop!
Epoch  73  trn-loss: 2346.5239  ndcg: 0.0383
Early Stop!
Epoch  74  trn-loss: 2301.0657  ndcg: 0.0395
Early Stop!
Epoch  75  trn-loss: 2336.5479  ndcg: 0.0348
Early Stop!
Epoch  76  trn-loss: 2329.3435  ndcg: 0.0379
Early Stop!
Epoch  77  trn-loss: 2316.7939  ndcg: 0.0391
Early Stop!
Epoch  78  trn-loss: 2319.9109  ndcg: 0.0365
Early Stop!
Epoch  79  trn-loss: 2308.0098  ndcg: 0.0397
Early Stop!
Epoch  80  trn-loss: 2358.7976  ndcg: 0.0373
Early Stop!
Epoch  81  trn-loss: 2306.8091  ndcg: 0.0374
Early Stop!
Epoch  82  trn-loss: 2322.6448  ndcg: 0.0374
Early Stop!
Epoch  83  trn-loss: 2300.8752  ndcg: 0.0374
Early Stop!
Epoch  84  trn-loss: 2355.3389  ndcg: 0.0363
Early Stop!
Epoch  85  trn-loss: 2278.1982  ndcg: 0.0379
Early Stop!
Epoch  86  trn-loss: 2238.3186  ndcg: 0.0378
Early Stop!
Epoch  87  trn-loss: 2357.0774  ndcg: 0.0410
Early Stop!
Epoch  88  trn-loss: 2338.4004  ndcg: 0.0380
Early Stop!
Epoch  89  trn-loss: 2287.2891  ndcg: 0.0357
Early Stop!
Epoch  90  trn-loss: 2363.2434  ndcg: 0.0377
Early Stop!
Epoch  91  trn-loss: 2339.6243  ndcg: 0.0352
Early Stop!
Epoch  92  trn-loss: 2268.0635  ndcg: 0.0379
Early Stop!
Epoch  93  trn-loss: 2257.4148  ndcg: 0.0378
Early Stop!
Epoch  94  trn-loss: 2281.1448  ndcg: 0.0364
Early Stop!
Epoch  95  trn-loss: 2284.7773  ndcg: 0.0365
Early Stop!
Epoch  96  trn-loss: 2292.9382  ndcg: 0.0379
Early Stop!
Epoch  97  trn-loss: 2309.1101  ndcg: 0.0384
Early Stop!
Epoch  98  trn-loss: 2353.2900  ndcg: 0.0381
Early Stop!
Epoch  99  trn-loss: 2286.4775  ndcg: 0.0387
Early Stop!
Epoch  100  trn-loss: 2329.0754  ndcg: 0.0370
Early Stop!
Epoch  101  trn-loss: 2246.2791  ndcg: 0.0386
Early Stop!
Epoch  102  trn-loss: 2345.8083  ndcg: 0.0373
Early Stop!
Epoch  103  trn-loss: 2286.8196  ndcg: 0.0366
Early Stop!
Epoch  104  trn-loss: 2272.6646  ndcg: 0.0386
Early Stop!
Epoch  105  trn-loss: 2300.0308  ndcg: 0.0395
Early Stop!
Epoch  106  trn-loss: 2292.8247  ndcg: 0.0381
Early Stop!
Epoch  107  trn-loss: 2245.8579  ndcg: 0.0382
Early Stop!
Epoch  108  trn-loss: 2241.8455  ndcg: 0.0371
Early Stop!
Epoch  109  trn-loss: 2281.0601  ndcg: 0.0352
Early Stop!
Epoch  110  trn-loss: 2257.4773  ndcg: 0.0386
Early Stop!
Epoch  111  trn-loss: 2295.0745  ndcg: 0.0384
Early Stop!
Epoch  112  trn-loss: 2318.1560  ndcg: 0.0358
Early Stop!
Epoch  113  trn-loss: 2284.7607  ndcg: 0.0406
Early Stop!
Epoch  114  trn-loss: 2346.8223  ndcg: 0.0386
Early Stop!
Epoch  115  trn-loss: 2326.8440  ndcg: 0.0367
Early Stop!
Epoch  116  trn-loss: 2317.3743  ndcg: 0.0405
Early Stop!
Epoch  117  trn-loss: 2259.1101  ndcg: 0.0383
Early Stop!
Epoch  118  trn-loss: 2273.6882  ndcg: 0.0370
Early Stop!
Epoch  119  trn-loss: 2270.6699  ndcg: 0.0390
main_edge.py:217: RuntimeWarning: invalid value encountered in true_divide
  recall = tmp / np.minimum(k, x_true_binary.sum(axis=1))
test:
Test NDCG@100=0.15480 (0.00092)
Test Recall@20=0.12905 (0.00115)
Test Recall@50=0.16541 (0.00131)
