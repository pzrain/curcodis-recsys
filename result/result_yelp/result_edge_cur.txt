n =  500505
sizes of edges =  500505
batch_size =  4170
src/main_edge_cur.py:203: RuntimeWarning: invalid value encountered in divide
  ndcg = dcg / idcg
Early Stop!
Epoch  0  trn-loss: 0.2717  ndcg: 0.0072
Early Stop!
Epoch  1  trn-loss: 0.2160  ndcg: 0.0071
Early Stop!
Epoch  2  trn-loss: 0.4710  ndcg: 0.0080
Early Stop!
Epoch  3  trn-loss: 0.5418  ndcg: 0.0076
Early Stop!
Epoch  4  trn-loss: 0.4806  ndcg: 0.0085
Early Stop!
Epoch  5  trn-loss: 0.6963  ndcg: 0.0086
Early Stop!
Epoch  6  trn-loss: 0.6205  ndcg: 0.0085
Early Stop!
Epoch  7  trn-loss: 0.5808  ndcg: 0.0073
Early Stop!
Epoch  8  trn-loss: 0.8705  ndcg: 0.0059
Early Stop!
Epoch  9  trn-loss: 0.8369  ndcg: 0.0055
Early Stop!
Epoch  10  trn-loss: 0.9719  ndcg: 0.0059
Early Stop!
Epoch  11  trn-loss: 1.4180  ndcg: 0.0055
Early Stop!
Epoch  12  trn-loss: 1.3337  ndcg: 0.0062
Early Stop!
Epoch  13  trn-loss: 1.2406  ndcg: 0.0070
Early Stop!
Epoch  14  trn-loss: 1.4867  ndcg: 0.0074
Early Stop!
Epoch  15  trn-loss: 1.4794  ndcg: 0.0087
Early Stop!
Epoch  16  trn-loss: 1.6523  ndcg: 0.0083
Early Stop!
Epoch  17  trn-loss: 2.1270  ndcg: 0.0058
Early Stop!
Epoch  18  trn-loss: 2.0597  ndcg: 0.0070
Early Stop!
Epoch  19  trn-loss: 2.2279  ndcg: 0.0068
Early Stop!
Epoch  20  trn-loss: 2.2452  ndcg: 0.0071
Early Stop!
Epoch  21  trn-loss: 2.4992  ndcg: 0.0071
Early Stop!
Epoch  22  trn-loss: 2.4581  ndcg: 0.0076
Early Stop!
Epoch  23  trn-loss: 2.9301  ndcg: 0.0075
Early Stop!
Epoch  24  trn-loss: 2.6235  ndcg: 0.0078
Early Stop!
Epoch  25  trn-loss: 2.8590  ndcg: 0.0084
Early Stop!
Epoch  26  trn-loss: 3.1389  ndcg: 0.0098
Early Stop!
Epoch  27  trn-loss: 3.5155  ndcg: 0.0088
Early Stop!
Epoch  28  trn-loss: 3.9457  ndcg: 0.0090
Early Stop!
Epoch  29  trn-loss: 4.0194  ndcg: 0.0080
Early Stop!
Epoch  30  trn-loss: 3.0154  ndcg: 0.0108
Early Stop!
Epoch  31  trn-loss: 3.5246  ndcg: 0.0108
Early Stop!
Epoch  32  trn-loss: 3.1008  ndcg: 0.0108
Early Stop!
Epoch  33  trn-loss: 3.6040  ndcg: 0.0108
Early Stop!
Epoch  34  trn-loss: 3.8424  ndcg: 0.0102
Early Stop!
Epoch  35  trn-loss: 4.2109  ndcg: 0.0104
Early Stop!
Epoch  36  trn-loss: 4.5622  ndcg: 0.0112
Early Stop!
Epoch  37  trn-loss: 5.1180  ndcg: 0.0111
Early Stop!
Epoch  38  trn-loss: 5.5867  ndcg: 0.0109
Early Stop!
Epoch  39  trn-loss: 5.4535  ndcg: 0.0101
Early Stop!
Epoch  40  trn-loss: 6.4925  ndcg: 0.0111
Early Stop!
Epoch  41  trn-loss: 6.6756  ndcg: 0.0105
Early Stop!
Epoch  42  trn-loss: 7.1537  ndcg: 0.0106
Early Stop!
Epoch  43  trn-loss: 7.6668  ndcg: 0.0102
Early Stop!
Epoch  44  trn-loss: 7.9655  ndcg: 0.0104
Early Stop!
Epoch  45  trn-loss: 9.2253  ndcg: 0.0109
Early Stop!
Epoch  46  trn-loss: 8.6589  ndcg: 0.0104
Early Stop!
Epoch  47  trn-loss: 9.7847  ndcg: 0.0113
Early Stop!
Epoch  48  trn-loss: 10.4492  ndcg: 0.0104
Early Stop!
Epoch  49  trn-loss: 10.7396  ndcg: 0.0110
Early Stop!
Epoch  50  trn-loss: 11.1104  ndcg: 0.0109
Early Stop!
Epoch  51  trn-loss: 12.3084  ndcg: 0.0109
Early Stop!
Epoch  52  trn-loss: 12.5757  ndcg: 0.0111
Early Stop!
Epoch  53  trn-loss: 13.3321  ndcg: 0.0112
Early Stop!
Epoch  54  trn-loss: 14.3589  ndcg: 0.0117
Early Stop!
Epoch  55  trn-loss: 14.4916  ndcg: 0.0117
Early Stop!
Epoch  56  trn-loss: 15.7691  ndcg: 0.0117
Early Stop!
Epoch  57  trn-loss: 16.5985  ndcg: 0.0116
Early Stop!
Epoch  58  trn-loss: 17.1543  ndcg: 0.0119
Early Stop!
Epoch  59  trn-loss: 18.6081  ndcg: 0.0109
Early Stop!
Epoch  60  trn-loss: 17.6255  ndcg: 0.0101
Early Stop!
Epoch  61  trn-loss: 18.8876  ndcg: 0.0118
Early Stop!
Epoch  62  trn-loss: 19.7642  ndcg: 0.0124
Early Stop!
Epoch  63  trn-loss: 20.0845  ndcg: 0.0115
Early Stop!
Epoch  64  trn-loss: 21.2902  ndcg: 0.0118
Early Stop!
Epoch  65  trn-loss: 23.1082  ndcg: 0.0105
Early Stop!
Epoch  66  trn-loss: 25.2486  ndcg: 0.0114
Early Stop!
Epoch  67  trn-loss: 26.0286  ndcg: 0.0113
Early Stop!
Epoch  68  trn-loss: 27.4993  ndcg: 0.0103
Early Stop!
Epoch  69  trn-loss: 28.5939  ndcg: 0.0107
Early Stop!
Epoch  70  trn-loss: 30.5158  ndcg: 0.0127
Early Stop!
Epoch  71  trn-loss: 31.2481  ndcg: 0.0118
Early Stop!
Epoch  72  trn-loss: 33.0720  ndcg: 0.0109
Early Stop!
Epoch  73  trn-loss: 35.7459  ndcg: 0.0115
Early Stop!
Epoch  74  trn-loss: 37.4322  ndcg: 0.0118
Early Stop!
Epoch  75  trn-loss: 38.9610  ndcg: 0.0108
Early Stop!
Epoch  76  trn-loss: 40.1656  ndcg: 0.0111
Early Stop!
Epoch  77  trn-loss: 42.4271  ndcg: 0.0107
Early Stop!
Epoch  78  trn-loss: 43.6920  ndcg: 0.0111
Early Stop!
Epoch  79  trn-loss: 45.7974  ndcg: 0.0113
Early Stop!
Epoch  80  trn-loss: 48.1980  ndcg: 0.0110
Early Stop!
Epoch  81  trn-loss: 49.7906  ndcg: 0.0110
Early Stop!
Epoch  82  trn-loss: 51.5736  ndcg: 0.0106
Early Stop!
Epoch  83  trn-loss: 53.3059  ndcg: 0.0108
Early Stop!
Epoch  84  trn-loss: 56.5517  ndcg: 0.0123
Early Stop!
Epoch  85  trn-loss: 56.7583  ndcg: 0.0112
Early Stop!
Epoch  86  trn-loss: 59.1833  ndcg: 0.0114
Early Stop!
Epoch  87  trn-loss: 63.5471  ndcg: 0.0108
Early Stop!
Epoch  88  trn-loss: 64.6673  ndcg: 0.0103
Early Stop!
Epoch  89  trn-loss: 70.3412  ndcg: 0.0102
Early Stop!
Epoch  90  trn-loss: 73.2494  ndcg: 0.0097
Early Stop!
Epoch  91  trn-loss: 76.6659  ndcg: 0.0105
Early Stop!
Epoch  92  trn-loss: 82.0690  ndcg: 0.0109
Early Stop!
Epoch  93  trn-loss: 85.2794  ndcg: 0.0117
Early Stop!
Epoch  94  trn-loss: 93.2152  ndcg: 0.0103
Early Stop!
Epoch  95  trn-loss: 106.2067  ndcg: 0.0103
Early Stop!
Epoch  96  trn-loss: 116.4118  ndcg: 0.0105
Early Stop!
Epoch  97  trn-loss: 129.7610  ndcg: 0.0106
Early Stop!
Epoch  98  trn-loss: 147.0512  ndcg: 0.0115
Early Stop!
Epoch  99  trn-loss: 194.3226  ndcg: 0.0104
Early Stop!
Epoch  100  trn-loss: 194.8853  ndcg: 0.0101
Early Stop!
Epoch  101  trn-loss: 191.2406  ndcg: 0.0108
Early Stop!
Epoch  102  trn-loss: 189.0665  ndcg: 0.0123
Early Stop!
Epoch  103  trn-loss: 184.9598  ndcg: 0.0116
Early Stop!
Epoch  104  trn-loss: 186.1215  ndcg: 0.0113
Early Stop!
Epoch  105  trn-loss: 183.9704  ndcg: 0.0120
Early Stop!
Epoch  106  trn-loss: 188.1708  ndcg: 0.0124
Early Stop!
Epoch  107  trn-loss: 180.7956  ndcg: 0.0113
Early Stop!
Epoch  108  trn-loss: 185.7583  ndcg: 0.0107
Early Stop!
Epoch  109  trn-loss: 184.5580  ndcg: 0.0112
Early Stop!
Epoch  110  trn-loss: 188.7980  ndcg: 0.0112
Early Stop!
Epoch  111  trn-loss: 184.8665  ndcg: 0.0109
Early Stop!
Epoch  112  trn-loss: 180.9779  ndcg: 0.0100
Early Stop!
Epoch  113  trn-loss: 179.8361  ndcg: 0.0113
Early Stop!
Epoch  114  trn-loss: 179.1352  ndcg: 0.0110
Early Stop!
Epoch  115  trn-loss: 178.8493  ndcg: 0.0109
Early Stop!
Epoch  116  trn-loss: 181.0779  ndcg: 0.0114
Early Stop!
Epoch  117  trn-loss: 178.3088  ndcg: 0.0118
Early Stop!
Epoch  118  trn-loss: 178.1070  ndcg: 0.0125
Early Stop!
Epoch  119  trn-loss: 173.0643  ndcg: 0.0111
src/main_edge_cur.py:218: RuntimeWarning: invalid value encountered in divide
  recall = tmp / np.minimum(k, x_true_binary.sum(axis=1))
test:
Test NDCG@100=0.07035 (0.00017)
Test Recall@20=0.07482 (0.00026)
Test Recall@50=0.12759 (0.00034)
