n =  500505
sizes of edges =  500505
batch_size =  4170
src/main_edge_cur_rearrange.py:204: RuntimeWarning: invalid value encountered in divide
  ndcg = dcg / idcg
Early Stop!
Epoch  0  trn-loss: 179.8333  ndcg: 0.0108
Early Stop!
Epoch  1  trn-loss: 172.9203  ndcg: 0.0115
Early Stop!
Epoch  2  trn-loss: 179.7173  ndcg: 0.0116
Early Stop!
Epoch  3  trn-loss: 181.0162  ndcg: 0.0114
Early Stop!
Epoch  4  trn-loss: 172.5252  ndcg: 0.0118
Early Stop!
Epoch  5  trn-loss: 174.8304  ndcg: 0.0114
Early Stop!
Epoch  6  trn-loss: 177.9865  ndcg: 0.0114
Early Stop!
Epoch  7  trn-loss: 175.2055  ndcg: 0.0118
Early Stop!
Epoch  8  trn-loss: 180.8289  ndcg: 0.0112
Early Stop!
Epoch  9  trn-loss: 175.1881  ndcg: 0.0103
Early Stop!
Epoch  10  trn-loss: 171.6999  ndcg: 0.0118
Early Stop!
Epoch  11  trn-loss: 173.9059  ndcg: 0.0111
Early Stop!
Epoch  12  trn-loss: 175.3048  ndcg: 0.0122
Early Stop!
Epoch  13  trn-loss: 177.0649  ndcg: 0.0105
Early Stop!
Epoch  14  trn-loss: 175.4904  ndcg: 0.0111
Early Stop!
Epoch  15  trn-loss: 172.9108  ndcg: 0.0128
Early Stop!
Epoch  16  trn-loss: 173.1690  ndcg: 0.0099
Early Stop!
Epoch  17  trn-loss: 173.5146  ndcg: 0.0108
Early Stop!
Epoch  18  trn-loss: 173.3511  ndcg: 0.0114
Early Stop!
Epoch  19  trn-loss: 174.6150  ndcg: 0.0115
Early Stop!
Epoch  20  trn-loss: 168.8820  ndcg: 0.0118
Early Stop!
Epoch  21  trn-loss: 175.3022  ndcg: 0.0114
Early Stop!
Epoch  22  trn-loss: 173.1537  ndcg: 0.0107
Early Stop!
Epoch  23  trn-loss: 170.9043  ndcg: 0.0116
Early Stop!
Epoch  24  trn-loss: 170.5419  ndcg: 0.0115
Early Stop!
Epoch  25  trn-loss: 172.8751  ndcg: 0.0120
Early Stop!
Epoch  26  trn-loss: 172.0804  ndcg: 0.0117
Early Stop!
Epoch  27  trn-loss: 174.0517  ndcg: 0.0106
Early Stop!
Epoch  28  trn-loss: 168.7463  ndcg: 0.0113
Early Stop!
Epoch  29  trn-loss: 172.0935  ndcg: 0.0115
Early Stop!
Epoch  30  trn-loss: 168.1186  ndcg: 0.0111
Early Stop!
Epoch  31  trn-loss: 169.7351  ndcg: 0.0108
Early Stop!
Epoch  32  trn-loss: 174.6964  ndcg: 0.0118
Early Stop!
Epoch  33  trn-loss: 170.2299  ndcg: 0.0110
Early Stop!
Epoch  34  trn-loss: 169.1560  ndcg: 0.0114
Early Stop!
Epoch  35  trn-loss: 174.4846  ndcg: 0.0104
Early Stop!
Epoch  36  trn-loss: 169.5190  ndcg: 0.0117
Early Stop!
Epoch  37  trn-loss: 170.9631  ndcg: 0.0111
Early Stop!
Epoch  38  trn-loss: 169.4211  ndcg: 0.0107
Early Stop!
Epoch  39  trn-loss: 168.7097  ndcg: 0.0106
Early Stop!
Epoch  40  trn-loss: 172.0063  ndcg: 0.0112
Early Stop!
Epoch  41  trn-loss: 169.7574  ndcg: 0.0122
Early Stop!
Epoch  42  trn-loss: 168.8624  ndcg: 0.0107
Early Stop!
Epoch  43  trn-loss: 168.3341  ndcg: 0.0112
Early Stop!
Epoch  44  trn-loss: 170.6611  ndcg: 0.0113
Early Stop!
Epoch  45  trn-loss: 168.0337  ndcg: 0.0111
Early Stop!
Epoch  46  trn-loss: 171.8267  ndcg: 0.0109
Early Stop!
Epoch  47  trn-loss: 166.3656  ndcg: 0.0114
Early Stop!
Epoch  48  trn-loss: 170.4481  ndcg: 0.0117
Early Stop!
Epoch  49  trn-loss: 170.8279  ndcg: 0.0115
Early Stop!
Epoch  50  trn-loss: 170.6026  ndcg: 0.0111
Early Stop!
Epoch  51  trn-loss: 171.5187  ndcg: 0.0110
Early Stop!
Epoch  52  trn-loss: 171.2505  ndcg: 0.0114
Early Stop!
Epoch  53  trn-loss: 171.3832  ndcg: 0.0115
Early Stop!
Epoch  54  trn-loss: 173.1310  ndcg: 0.0105
Early Stop!
Epoch  55  trn-loss: 168.6940  ndcg: 0.0105
Early Stop!
Epoch  56  trn-loss: 165.2284  ndcg: 0.0114
Early Stop!
Epoch  57  trn-loss: 166.8036  ndcg: 0.0116
Early Stop!
Epoch  58  trn-loss: 170.5270  ndcg: 0.0101
Early Stop!
Epoch  59  trn-loss: 166.4381  ndcg: 0.0111
Early Stop!
Epoch  60  trn-loss: 164.7155  ndcg: 0.0103
Early Stop!
Epoch  61  trn-loss: 172.1819  ndcg: 0.0111
Early Stop!
Epoch  62  trn-loss: 169.6958  ndcg: 0.0107
Early Stop!
Epoch  63  trn-loss: 168.4972  ndcg: 0.0121
Early Stop!
Epoch  64  trn-loss: 166.3326  ndcg: 0.0115
Early Stop!
Epoch  65  trn-loss: 168.3252  ndcg: 0.0110
Early Stop!
Epoch  66  trn-loss: 166.4393  ndcg: 0.0106
Early Stop!
Epoch  67  trn-loss: 170.4067  ndcg: 0.0112
Early Stop!
Epoch  68  trn-loss: 166.3400  ndcg: 0.0107
Early Stop!
Epoch  69  trn-loss: 172.7499  ndcg: 0.0106
Early Stop!
Epoch  70  trn-loss: 170.9233  ndcg: 0.0106
Early Stop!
Epoch  71  trn-loss: 165.9028  ndcg: 0.0099
Early Stop!
Epoch  72  trn-loss: 168.6741  ndcg: 0.0117
Early Stop!
Epoch  73  trn-loss: 169.4157  ndcg: 0.0126
Early Stop!
Epoch  74  trn-loss: 172.5272  ndcg: 0.0114
Early Stop!
Epoch  75  trn-loss: 167.5931  ndcg: 0.0120
Early Stop!
Epoch  76  trn-loss: 163.9487  ndcg: 0.0113
Early Stop!
Epoch  77  trn-loss: 168.6804  ndcg: 0.0123
Early Stop!
Epoch  78  trn-loss: 169.3003  ndcg: 0.0113
Early Stop!
Epoch  79  trn-loss: 171.1490  ndcg: 0.0117
Early Stop!
Epoch  80  trn-loss: 169.0156  ndcg: 0.0103
Early Stop!
Epoch  81  trn-loss: 167.1398  ndcg: 0.0119
Early Stop!
Epoch  82  trn-loss: 168.3179  ndcg: 0.0106
Early Stop!
Epoch  83  trn-loss: 166.3895  ndcg: 0.0109
Early Stop!
Epoch  84  trn-loss: 166.9173  ndcg: 0.0103
Early Stop!
Epoch  85  trn-loss: 169.0789  ndcg: 0.0107
Early Stop!
Epoch  86  trn-loss: 164.7646  ndcg: 0.0109
Early Stop!
Epoch  87  trn-loss: 171.4157  ndcg: 0.0111
Early Stop!
Epoch  88  trn-loss: 169.4004  ndcg: 0.0103
Early Stop!
Epoch  89  trn-loss: 168.1498  ndcg: 0.0114
Early Stop!
Epoch  90  trn-loss: 168.2352  ndcg: 0.0117
Early Stop!
Epoch  91  trn-loss: 168.9728  ndcg: 0.0112
Early Stop!
Epoch  92  trn-loss: 167.1890  ndcg: 0.0108
Early Stop!
Epoch  93  trn-loss: 169.2068  ndcg: 0.0103
Early Stop!
Epoch  94  trn-loss: 173.5404  ndcg: 0.0116
Early Stop!
Epoch  95  trn-loss: 167.6410  ndcg: 0.0111
Early Stop!
Epoch  96  trn-loss: 160.6079  ndcg: 0.0107
Early Stop!
Epoch  97  trn-loss: 164.9569  ndcg: 0.0106
Early Stop!
Epoch  98  trn-loss: 170.4881  ndcg: 0.0120
Early Stop!
Epoch  99  trn-loss: 165.4175  ndcg: 0.0112
Early Stop!
Epoch  100  trn-loss: 167.0034  ndcg: 0.0110
Early Stop!
Epoch  101  trn-loss: 169.7437  ndcg: 0.0109
Early Stop!
Epoch  102  trn-loss: 169.2569  ndcg: 0.0116
Early Stop!
Epoch  103  trn-loss: 166.2471  ndcg: 0.0116
Early Stop!
Epoch  104  trn-loss: 170.6910  ndcg: 0.0111
Early Stop!
Epoch  105  trn-loss: 169.8855  ndcg: 0.0109
Early Stop!
Epoch  106  trn-loss: 166.2429  ndcg: 0.0105
Early Stop!
Epoch  107  trn-loss: 169.2066  ndcg: 0.0112
Early Stop!
Epoch  108  trn-loss: 166.0506  ndcg: 0.0116
Early Stop!
Epoch  109  trn-loss: 166.2951  ndcg: 0.0110
Early Stop!
Epoch  110  trn-loss: 167.1777  ndcg: 0.0111
Early Stop!
Epoch  111  trn-loss: 167.0561  ndcg: 0.0108
Early Stop!
Epoch  112  trn-loss: 167.3518  ndcg: 0.0108
Early Stop!
Epoch  113  trn-loss: 166.5359  ndcg: 0.0115
Early Stop!
Epoch  114  trn-loss: 168.8667  ndcg: 0.0104
Early Stop!
Epoch  115  trn-loss: 169.3581  ndcg: 0.0108
Early Stop!
Epoch  116  trn-loss: 166.9468  ndcg: 0.0109
Early Stop!
Epoch  117  trn-loss: 163.3292  ndcg: 0.0115
Early Stop!
Epoch  118  trn-loss: 168.2924  ndcg: 0.0117
Early Stop!
Epoch  119  trn-loss: 166.4482  ndcg: 0.0104
src/main_edge_cur_rearrange.py:219: RuntimeWarning: invalid value encountered in divide
  recall = tmp / np.minimum(k, x_true_binary.sum(axis=1))
test:
Test NDCG@100=0.07169 (0.00017)
Test Recall@20=0.07605 (0.00026)
Test Recall@50=0.12915 (0.00034)
